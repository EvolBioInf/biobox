\begin{algorithmic}[1]
  \REQUIRE $n$ \COMMENT{sample size}
  \REQUIRE $\mathrm{pairs}$ \COMMENT{array of $n-1$ pairs of children}
  \REQUIRE $\mathrm{tree}$ \COMMENT{array of $2n-1$ tree nodes}
  \ENSURE Tree topology
  \FOR{$i\leftarrow n$ \TO $2$}
  \STATE $p\leftarrow 2\times n - i + 1$ \COMMENT{Parent}
  \STATE $c\leftarrow \mathrm{pairs}[p-n].c_1$ \COMMENT{Index of first child}
  \STATE $\mathrm{tree}[p].\mathrm{child}1\leftarrow\mathrm{tree}[c]$ 
  \STATE $\mathrm{tree}[c]\leftarrow\mathrm{tree}[i]$ \COMMENT{Replace first child}
  \STATE $c\leftarrow \mathrm{pairs}[p-n].c_2$ \COMMENT{Index of second child}
   \STATE $\mathrm{tree}[p].\mathrm{child2}\leftarrow\mathrm{tree}[c]$
   \STATE $\mathrm{tree}[c]\leftarrow\mathrm{tree}[p]$
   \COMMENT{Replace second child by parent}
\ENDFOR
\end{algorithmic}
